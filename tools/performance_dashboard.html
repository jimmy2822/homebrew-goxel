<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goxel v14.0 Performance Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        h1 {
            font-size: 2.5em;
            font-weight: 300;
            text-align: center;
        }
        
        .subtitle {
            text-align: center;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .card h2 {
            font-size: 1.2em;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .metric-label {
            font-weight: 500;
            color: #555;
        }
        
        .metric-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .metric-value.good {
            color: #27ae60;
        }
        
        .metric-value.warning {
            color: #f39c12;
        }
        
        .metric-value.bad {
            color: #e74c3c;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .chart-container {
            margin: 20px 0;
            height: 300px;
            position: relative;
        }
        
        canvas {
            max-width: 100%;
            height: auto;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .test-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #95a5a6;
        }
        
        .test-item.pass {
            border-left-color: #27ae60;
        }
        
        .test-item.fail {
            border-left-color: #e74c3c;
        }
        
        .test-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .test-metric {
            font-size: 0.9em;
            color: #666;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-indicator.green {
            background: #27ae60;
        }
        
        .status-indicator.yellow {
            background: #f39c12;
        }
        
        .status-indicator.red {
            background: #e74c3c;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
        
        .refresh-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.2s;
        }
        
        .refresh-btn:hover {
            background: #2980b9;
        }
        
        .timestamp {
            text-align: center;
            color: #666;
            margin: 20px 0;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>Goxel v14.0 Performance Dashboard</h1>
            <p class="subtitle">Real-time Performance Monitoring & Validation</p>
        </div>
    </div>
    
    <div class="container">
        <div class="timestamp">
            Last Updated: <span id="last-update">Loading...</span>
            <button class="refresh-btn" onclick="refreshData()">Refresh</button>
        </div>
        
        <div class="dashboard">
            <!-- Performance Overview Card -->
            <div class="card">
                <h2>Performance Overview</h2>
                <div class="metric">
                    <span class="metric-label">Average Latency</span>
                    <span class="metric-value" id="avg-latency">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Throughput</span>
                    <span class="metric-value" id="throughput">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Memory Usage</span>
                    <span class="metric-value" id="memory-usage">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Success Rate</span>
                    <span class="metric-value" id="success-rate">--</span>
                </div>
            </div>
            
            <!-- Target Achievement Card -->
            <div class="card">
                <h2>Target Achievement</h2>
                <div class="metric">
                    <span class="metric-label">Latency Target (&lt;2.1ms)</span>
                    <span class="status-indicator" id="latency-status"></span>
                    <span class="metric-value" id="latency-target">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Throughput Target (&gt;1000 ops/s)</span>
                    <span class="status-indicator" id="throughput-status"></span>
                    <span class="metric-value" id="throughput-target">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Memory Target (&lt;50MB)</span>
                    <span class="status-indicator" id="memory-status"></span>
                    <span class="metric-value" id="memory-target">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Performance Improvement</span>
                    <span class="status-indicator" id="improvement-status"></span>
                    <span class="metric-value" id="improvement-factor">--</span>
                </div>
            </div>
            
            <!-- CLI vs Daemon Comparison -->
            <div class="card" style="grid-column: span 2;">
                <h2>CLI vs Daemon Performance</h2>
                <div class="chart-container">
                    <canvas id="comparison-chart"></canvas>
                </div>
            </div>
            
            <!-- Test Results Grid -->
            <div class="card" style="grid-column: span 2;">
                <h2>Individual Test Results</h2>
                <div class="test-grid" id="test-results">
                    <!-- Dynamically populated -->
                </div>
            </div>
            
            <!-- Latency Distribution -->
            <div class="card">
                <h2>Latency Distribution</h2>
                <div class="metric">
                    <span class="metric-label">P50 (Median)</span>
                    <span class="metric-value" id="p50-latency">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">P90</span>
                    <span class="metric-value" id="p90-latency">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">P95</span>
                    <span class="metric-value" id="p95-latency">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">P99</span>
                    <span class="metric-value" id="p99-latency">--</span>
                </div>
            </div>
            
            <!-- System Resources -->
            <div class="card">
                <h2>System Resources</h2>
                <div class="metric">
                    <span class="metric-label">CPU Usage</span>
                    <span class="metric-value" id="cpu-usage">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Memory Delta</span>
                    <span class="metric-value" id="memory-delta">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Active Connections</span>
                    <span class="metric-value" id="connections">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Uptime</span>
                    <span class="metric-value" id="uptime">--</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Goxel v14.0 Performance Dashboard | Agent-4 (David Park)</p>
    </div>
    
    <!-- Include Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Dashboard functionality
        let comparisonChart = null;
        
        function updateMetricStatus(value, target, element, isHigherBetter = false) {
            const passed = isHigherBetter ? value >= target : value <= target;
            element.classList.remove('good', 'warning', 'bad');
            
            if (passed) {
                element.classList.add('good');
                return 'green';
            } else if (Math.abs(value - target) / target < 0.2) {
                element.classList.add('warning');
                return 'yellow';
            } else {
                element.classList.add('bad');
                return 'red';
            }
        }
        
        function updateStatusIndicator(elementId, status) {
            const indicator = document.getElementById(elementId);
            indicator.classList.remove('green', 'yellow', 'red');
            indicator.classList.add(status);
        }
        
        function formatNumber(num, decimals = 1) {
            return num.toFixed(decimals);
        }
        
        function refreshData() {
            // In a real implementation, this would fetch data from the server
            // For now, we'll use mock data to demonstrate the dashboard
            
            const mockData = {
                timestamp: new Date().toLocaleString(),
                overview: {
                    avgLatency: 1.85,
                    throughput: 1250,
                    memoryUsage: 42.3,
                    successRate: 98.5
                },
                targets: {
                    latency: { value: 1.85, target: 2.1 },
                    throughput: { value: 1250, target: 1000 },
                    memory: { value: 42.3, target: 50 },
                    improvement: { value: 7.8, target: 7.0 }
                },
                latencyDistribution: {
                    p50: 1.65,
                    p90: 2.05,
                    p95: 2.18,
                    p99: 2.45
                },
                resources: {
                    cpuUsage: 15.2,
                    memoryDelta: 2.1,
                    connections: 8,
                    uptime: "2h 14m"
                },
                tests: [
                    { name: "Single Voxel Add", latency: 1.2, passed: true },
                    { name: "Batch Operations", latency: 1.8, passed: true },
                    { name: "File Load", latency: 2.3, passed: false },
                    { name: "Export Mesh", latency: 1.9, passed: true },
                    { name: "Query Voxel", latency: 0.8, passed: true },
                    { name: "Remove Voxel", latency: 1.1, passed: true }
                ],
                comparison: {
                    labels: ["Latency", "Throughput", "Memory", "Startup"],
                    cli: [15.2, 180, 58, 25],
                    daemon: [1.85, 1250, 42.3, 8.5]
                }
            };
            
            // Update timestamp
            document.getElementById('last-update').textContent = mockData.timestamp;
            
            // Update overview
            document.getElementById('avg-latency').textContent = formatNumber(mockData.overview.avgLatency) + ' ms';
            document.getElementById('throughput').textContent = formatNumber(mockData.overview.throughput, 0) + ' ops/s';
            document.getElementById('memory-usage').textContent = formatNumber(mockData.overview.memoryUsage) + ' MB';
            document.getElementById('success-rate').textContent = formatNumber(mockData.overview.successRate) + '%';
            
            // Update targets
            document.getElementById('latency-target').textContent = formatNumber(mockData.targets.latency.value) + ' ms';
            updateStatusIndicator('latency-status', 
                mockData.targets.latency.value <= mockData.targets.latency.target ? 'green' : 'red');
            
            document.getElementById('throughput-target').textContent = formatNumber(mockData.targets.throughput.value, 0) + ' ops/s';
            updateStatusIndicator('throughput-status',
                mockData.targets.throughput.value >= mockData.targets.throughput.target ? 'green' : 'red');
            
            document.getElementById('memory-target').textContent = formatNumber(mockData.targets.memory.value) + ' MB';
            updateStatusIndicator('memory-status',
                mockData.targets.memory.value <= mockData.targets.memory.target ? 'green' : 'red');
            
            document.getElementById('improvement-factor').textContent = formatNumber(mockData.targets.improvement.value) + 'x';
            updateStatusIndicator('improvement-status',
                mockData.targets.improvement.value >= mockData.targets.improvement.target ? 'green' : 'red');
            
            // Update latency distribution
            document.getElementById('p50-latency').textContent = formatNumber(mockData.latencyDistribution.p50) + ' ms';
            document.getElementById('p90-latency').textContent = formatNumber(mockData.latencyDistribution.p90) + ' ms';
            document.getElementById('p95-latency').textContent = formatNumber(mockData.latencyDistribution.p95) + ' ms';
            document.getElementById('p99-latency').textContent = formatNumber(mockData.latencyDistribution.p99) + ' ms';
            
            // Update resources
            document.getElementById('cpu-usage').textContent = formatNumber(mockData.resources.cpuUsage) + '%';
            document.getElementById('memory-delta').textContent = '+' + formatNumber(mockData.resources.memoryDelta) + ' MB';
            document.getElementById('connections').textContent = mockData.resources.connections;
            document.getElementById('uptime').textContent = mockData.resources.uptime;
            
            // Update test results
            const testResultsContainer = document.getElementById('test-results');
            testResultsContainer.innerHTML = '';
            
            mockData.tests.forEach(test => {
                const testDiv = document.createElement('div');
                testDiv.className = `test-item ${test.passed ? 'pass' : 'fail'}`;
                testDiv.innerHTML = `
                    <div class="test-name">${test.name}</div>
                    <div class="test-metric">Latency: ${formatNumber(test.latency)} ms</div>
                    <div class="test-metric">Status: ${test.passed ? '✅ Pass' : '❌ Fail'}</div>
                `;
                testResultsContainer.appendChild(testDiv);
            });
            
            // Update comparison chart
            updateComparisonChart(mockData.comparison);
        }
        
        function updateComparisonChart(data) {
            const ctx = document.getElementById('comparison-chart').getContext('2d');
            
            if (comparisonChart) {
                comparisonChart.destroy();
            }
            
            comparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'v13.4 CLI',
                            data: data.cli,
                            backgroundColor: 'rgba(255, 159, 64, 0.8)',
                            borderColor: 'rgba(255, 159, 64, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'v14.0 Daemon',
                            data: data.daemon,
                            backgroundColor: 'rgba(54, 162, 235, 0.8)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Performance Metrics'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed.y;
                                    
                                    // Add units based on metric
                                    switch(context.dataIndex) {
                                        case 0: label += ' ms'; break;
                                        case 1: label += ' ops/s'; break;
                                        case 2: label += ' MB'; break;
                                        case 3: label += ' ms'; break;
                                    }
                                    
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            refreshData();
            
            // Auto-refresh every 30 seconds
            setInterval(refreshData, 30000);
        });
    </script>
</body>
</html>